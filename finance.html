<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AgroLink — Finance</title>

<!-- Fonts & Icons (same as other pages) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet"/>

<!-- Styles (your global stylesheet) -->
<link rel="stylesheet" href="assets/style.css" />

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

<!-- Minimal modal styles (keeps everything self-contained) -->
<style>
/* Modal overlay */
.modal {
  position: fixed;
  inset: 0;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(0,0,0,0.45);
  z-index: 9999;
}
.modal.hidden { display: none; }
.modal-card {
  background: var(--card, #fff);
  border-radius: 12px;
  width: 380px;
  max-width: calc(100% - 32px);
  padding: 16px;
  box-shadow: 0 10px 30px rgba(2,6,23,0.12);
  font-family: Inter, system-ui, Arial, sans-serif;
}
.modal-card h3 { margin: 0 0 8px; font-size:18px; }
.modal-row { display:flex; flex-direction:column; gap:8px; margin-bottom:8px; }
.modal-row label { font-size:13px; color:var(--muted,#6b7280); display:block; }
.modal-row input[type="text"], .modal-row input[type="number"], .modal-row input[type="date"], .modal-row select {
  width:100%; padding:8px 10px; border-radius:8px; border:1px solid var(--ring,#e5e7eb); background:var(--card);
  font-size:14px;
}
.modal-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:10px; }
.btn-sm { padding:6px 10px; font-size:13px; border-radius:8px; }
</style>
</head>
<body>
<div class="layout">
  <aside class="sidebar">
    <div class="brand"><i class="ri-plant-line"></i> AgroLink</div>
    <nav class="nav">
      <h4>MENU</h4>
      <a href="index.html"><i class="ri-dashboard-line"></i> Dashboard</a>
      <a href="crops.html"><i class="ri-seedling-line"></i> Crops</a>
      <a href="livestock.html"><i class="ri-medicine-bottle-line"></i> Livestock</a>
      <a href="fields.html"><i class="ri-map-pin-line"></i> Fields</a>
      <a href="weather.html"><i class="ri-cloud-windy-line"></i> Weather</a>
      <a href="equipment.html"><i class="ri-tools-line"></i> Equipment</a>
      <a href="finance.html" class="active"><i class="ri-money-dollar-box-line"></i> Finance</a>
      <a href="reports.html"><i class="ri-bar-chart-2-line"></i> Reports</a>
      <a href="settings.html"><i class="ri-settings-3-line"></i> Settings</a>
    </nav>
  </aside>

  <main>
    <div class="topbar">
      <div class="search"><i class="ri-search-line"></i><input id="globalSearch" placeholder="Search invoices, expenses, etc..." /></div>
      <div class="top-actions">
        <button class="btn"><i class="ri-calendar-line"></i><span id="rangeLabel">Jan 2025</span></button>
        <button id="exportCsv" class="btn"><i class="ri-file-download-line"></i> Export CSV</button>
        <button id="addTransaction" class="btn btn-primary"><i class="ri-add-circle-line"></i> Transaction</button>
        <button id="themeToggle" class="theme-toggle"><i class="ri-contrast-2-line"></i> Theme</button>
        <div class="avatar">
          <img src="https://i.pravatar.cc/60?img=31" alt="">
          <div>
            <div style="font-weight:600">Oluwasegun Oyebode</div>
            <small class="subtitle">Farm Director</small>
          </div>
        </div>
      </div>
    </div>

    <div class="content">
      <div style="display:flex;justify-content:space-between;align-items:flex-end;flex-wrap:wrap;gap:14px">
        <div>
          <div class="page-title">Finance Dashboard</div>
          <div class="subtitle">Revenue, expenses, cashflow and forecasting for smarter farm finance.</div>
        </div>
        <div style="display:flex;gap:8px">
          <button id="refreshData" class="btn"><i class="ri-refresh-line"></i> Refresh</button>
          <select id="timeRange" class="btn" style="padding:6px 10px;">
            <option value="1M">Last 1M</option>
            <option value="3M">Last 3M</option>
            <option value="6M" selected>Last 6M</option>
            <option value="1Y">1 Year</option>
            <option value="ALL">All</option>
          </select>
        </div>
      </div>

      <!-- KPIs -->
      <section class="grid metrics" style="margin-top:16px">
        <div class="card">
          <div class="metric">
            <div>
              <small>Total Revenue</small>
              <h3 id="totalRevenue">$124.3k</h3>
              <small class="up" id="revChange">▲ +8.2%</small>
            </div>
            <div class="icon" style="background:#eef2ff;color:#4f46e5"><i class="ri-money-dollar-circle-line"></i></div>
          </div>
        </div>
        <div class="card">
          <div class="metric">
            <div>
              <small>Total Expenses</small>
              <h3 id="totalExpenses">$78.9k</h3>
              <small class="down" id="expChange">▼ −3.0%</small>
            </div>
            <div class="icon" style="background:#fff7ed;color:#f97316"><i class="ri-stack-line"></i></div>
          </div>
        </div>
        <div class="card">
          <div class="metric">
            <div>
              <small>Profit</small>
              <h3 id="profit">$45.4k</h3>
              <small class="muted">Net (Revenue − Expenses)</small>
            </div>
            <div class="icon" style="background:#ecfdf5;color:#16a34a"><i class="ri-bar-chart-line"></i></div>
          </div>
        </div>
        <div class="card">
          <div class="metric">
            <div>
              <small>Cash Flow</small>
              <h3 id="cashFlow">$12.1k</h3>
              <small class="muted">Rolling 30-day</small>
            </div>
            <div class="icon" style="background:#ecfeff;color:#0891b2"><i class="ri-repeat-line"></i></div>
          </div>
        </div>
      </section>

      <!-- Charts row -->
      <section class="split" style="margin-top:16px">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <h4>Revenue vs Expenses</h4>
            <div style="display:flex;gap:8px;align-items:center">
              <label class="small-muted">Category</label>
              <select id="categoryFilter" class="btn" style="padding:6px 10px;">
                <option value="all">All</option>
                <option value="Crops">Crops</option>
                <option value="Livestock">Livestock</option>
                <option value="Equipment">Equipment</option>
                <option value="Labor">Labor</option>
                <option value="Supplies">Supplies</option>
              </select>
            </div>
          </div>
          <canvas id="revExpChart" height="180"></canvas>
        </div>

        <div class="card">
          <h4>Expense Distribution</h4>
          <canvas id="expensePie" height="180"></canvas>
          <div style="margin-top:8px;text-align:center"><button id="exportExpenses" class="btn">Export Expenses</button></div>
        </div>
      </section>

      <!-- Cashflow timeline + Forecast -->
      <section class="card" style="margin-top:16px">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <h4>Cash Flow Timeline & Forecast</h4>
          <div style="display:flex;gap:8px">
            <button id="toggleForecast" class="btn">Toggle Forecast</button>
            <button id="downloadReport" class="btn">Download Report</button>
          </div>
        </div>
        <canvas id="cashflowChart" height="120"></canvas>
      </section>

      <!-- Expense table with filters -->
      <section class="card" style="margin-top:16px">
        <h4>Expense Tracker</h4>
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px;">
          <input id="expenseSearch" placeholder="Search expense description..." class="btn" style="padding:8px;width:320px" />
          <select id="expenseCategory" class="btn" style="padding:6px 10px;">
            <option value="all">All Categories</option>
            <option value="Crops">Crops</option>
            <option value="Livestock">Livestock</option>
            <option value="Equipment">Equipment</option>
            <option value="Labor">Labor</option>
            <option value="Supplies">Supplies</option>
          </select>
          <button id="addExpenseBtn" class="btn btn-primary">Add Expense</button>
          <button id="exportExpenseCsv" class="btn">Export CSV</button>
        </div>

        <div class="table-wrap">
          <table id="expenseTable" style="width:100%;border-collapse:collapse;margin-top:10px;font-size:14px;">
            <thead style="background:var(--muted);text-align:left">
              <tr>
                <th style="padding:8px">Date</th>
                <th>Category</th>
                <th>Description</th>
                <th>Amount</th>
                <th>Receipt</th>
                <th style="text-align:center">Action</th>
              </tr>
            </thead>
            <tbody>
              <!-- dynamic -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- Invoices / Receipts -->
      <section class="card" style="margin-top:16px">
        <h4>Invoices & Receivables</h4>
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px;">
          <button id="newInvoice" class="btn btn-primary">Create Invoice</button>
          <button id="exportInvoices" class="btn">Export Invoices</button>
        </div>

        <div class="table-wrap">
          <table id="invoiceTable" style="width:100%;border-collapse:collapse;margin-top:10px;font-size:14px;">
            <thead style="background:var(--muted);text-align:left">
              <tr>
                <th style="padding:8px">Invoice #</th>
                <th>Client</th>
                <th>Date</th>
                <th>Amount</th>
                <th>Status</th>
                <th style="text-align:center">Action</th>
              </tr>
            </thead>
            <tbody>
              <!-- dynamic -->
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </main>
</div>

<!-- Floating Actions -->
<div class="footer-actions">
  <button class="fab"><i class="ri-equalizer-line"></i></button>
  <button class="fab" style="background:#22c55e"><i class="ri-question-line"></i></button>
</div>

<!-- Expense Modal -->
<div id="expenseModal" class="modal hidden" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="expenseModalTitle">
    <h3 id="expenseModalTitle">Add Expense</h3>
    <div class="modal-row">
      <label for="expDate">Date</label>
      <input id="expDate" type="date" />
    </div>
    <div class="modal-row">
      <label for="expCategory">Category</label>
      <select id="expCategory">
        <option value="Crops">Crops</option>
        <option value="Livestock">Livestock</option>
        <option value="Equipment">Equipment</option>
        <option value="Labor">Labor</option>
        <option value="Supplies">Supplies</option>
      </select>
    </div>
    <div class="modal-row">
      <label for="expDesc">Description</label>
      <input id="expDesc" type="text" placeholder="e.g. Fertilizer batch #A1" />
    </div>
    <div class="modal-row">
      <label for="expAmt">Amount</label>
      <input id="expAmt" type="number" placeholder="0.00" />
    </div>
    <div class="modal-actions">
      <button id="saveExpense" class="btn btn-primary btn-sm">Save Expense</button>
      <button class="btn btn-sm" onclick="closeModal('expenseModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- Invoice Modal -->
<div id="invoiceModal" class="modal hidden" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="invoiceModalTitle">
    <h3 id="invoiceModalTitle">Create Invoice</h3>
    <div class="modal-row">
      <label for="invClient">Client</label>
      <input id="invClient" type="text" placeholder="Client name" />
    </div>
    <div class="modal-row">
      <label for="invDate">Date</label>
      <input id="invDate" type="date" />
    </div>
    <div class="modal-row">
      <label for="invAmt">Amount</label>
      <input id="invAmt" type="number" placeholder="0.00" />
    </div>
    <div class="modal-row">
      <label for="invStatus">Status</label>
      <select id="invStatus">
        <option value="Pending">Pending</option>
        <option value="Paid">Paid</option>
      </select>
    </div>
    <div class="modal-actions">
      <button id="saveInvoice" class="btn btn-primary btn-sm">Save Invoice</button>
      <button class="btn btn-sm" onclick="closeModal('invoiceModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- App scripts -->
<script src="assets/script.js"></script>
<script src="assets/finance.js"></script>


<!-- Reusable Modal -->
<div id="modalOverlay" class="modal-overlay" style="display:none;">
  <div class="modal">
    <div class="modal-header">
      <h3 id="modalTitle">Add Record</h3>
      <button id="modalClose" class="btn">×</button>
    </div>
    <form id="modalForm" class="modal-body">
      <!-- Dynamic fields will be injected here -->
    </form>
    <div class="modal-footer">
      <button type="submit" form="modalForm" class="btn btn-primary">Save</button>
    </div>
  </div>
</div>

</body>
</html>
